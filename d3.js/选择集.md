# 选择集

## 元素选择 
说明：`d3.select()`、`d3.selectAll()` 返回值是一组选择，该选择是一组元素。D3 绑定额外的方法到该数组上（在该对象与数组间添加了一层原型链 `d3.selection.prototype`），可以在选中的元素上应用操作，例如为所有选中的元素设置属性值。

> `d3.select()` 、`d3.selectAll()` 返回一个选集 selection，它是 D3 操作 DOM 的入口
> `selection.data()` 操作的结果是 update 选择，这表示选择的 DOM 元素已成功绑定到指定的数据元素。update 选择还包含对 enter 和 exit 的选择。

#### 选择集（`selectoin`）
* selectoin.select(selector): 选中第一个目标元素
* selectoin.selectAll(selector): 选中所有符合的目标元素

> 说明：当没有任何元素符合条件时，方法返回的是一个空的选择结果（selection）

* selectoin.append(name)
* selectoin.insert(name, before)
* selectoin.remove()
* selectoin.empty()
* selectoin.filter(filter)
* selectoin.style(name, value, priority)
* selectoin.classed(name, value)
* selectoin.attr(name, value)
* selectoin.property(name, value)
* selectoin.html(value)
* selectoin.text(value)
* selectoin.size()
* selectoin.node()(type, listener, capture)

> 说明：`attr()`、`text()`中赋值时可使用函数，如 `function (data, i) { console.log(this); }` ，其中 `data` 指每一项数据，`i` 指索引，`this` 指当前 DOM 元素

* data(value, key) 连接指定的一组数据的和当前选择
* datum(value) 获取或设置每个选定的元素绑定的数据，不计算一个连接（因此不计算 enter 和 exit 的选择）
* each(callback) 对当前指定的每个元素进行处理
* sort(comparator) 根据指定的 comparator 函数对当前选择的元素排序
* order() 重新插入元素到文档，使文档顺序选与择顺序就相匹配
* call(callback) 调用指定函数，并返回当前选择（方便链式调用）
    * `svg.append('g').call(axis)` 与 `axis(svg.append('g'))` 作用一样;
* interrupt(name) 立即中断当前的过渡
* transition(name) 为当前选择添加过渡效果

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>D3.js - 散点图</title>
    <style>
        .axis path,
        .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }

        .axis text {
            font-family: sans-serif;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <script src="http://d3js.org/d3.v3.js" charset="utf-8"></script>
    <script>
        let w = 400;
        let h = 300;
        let padding = 30;
        let dataSet = [[5, 20], [480, 90], [250, 50], [100, 33], [330, 95], [410, 12], [475, 44], [25, 67], [85, 21], [220, 88]];

        let svg = d3.select('body')
            .append('svg')
            .attr('width', w)
            .attr('height', h);

        let xScale = d3.scale.linear()
            .domain([0, d3.max(dataSet, data => data[0])])
            .range([padding, w - padding * 2]);

        let yScale = d3.scale.linear()
            .domain([0, d3.max(dataSet, data => data[1])])
            .range([h - padding, padding]);

        let rScale = d3.scale.linear()
            .domain([0, d3.max(dataSet, data => data[1])])
            .range([4, 10]);

        let circles = svg.selectAll('circle')
            .data(dataSet)
            .enter()
            .append('circle');

        let xAxis = d3.svg.axis()
            .scale(xScale)
            .ticks(6)
            .orient('bottom');

        let yAxis = d3.svg.axis()
            .scale(yScale)
            .ticks(5)
            .orient('left');

        svg.append('g')
            .attr('class', 'axis')
            .attr('transform', `translate(0, ${h - padding})`)
            .call(xAxis);

        svg.append('g')
            .attr('class', 'axis')
            .attr('transform', `translate(${padding}, 0)`)
            .call(yAxis);

        circles.attr('cx', data => xScale(data[0]))
            .attr('cy', data => yScale(data[1]))
            .attr('r', data => rScale(data[1]));
    </script>
</body>
</html>
```